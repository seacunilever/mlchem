
<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>mlchem.chem.visualise package &#8212; mlchem 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="_static/bizstyle.css?v=5283bb3d" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=390bf028" />
    
    <script src="_static/documentation_options.js?v=2709fde1"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="mlchem.ml package" href="mlchem.ml.html" />
    <link rel="prev" title="mlchem.chem.calculator package" href="mlchem.chem.calculator.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mlchem.ml.html" title="mlchem.ml package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mlchem.chem.calculator.html" title="mlchem.chem.calculator package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">mlchem 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" ><strong>mlchem package</strong></a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="mlchem.html" ><strong>chem and ml subpackages</strong></a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="mlchem.chem.html" accesskey="U"><strong>mlchem.chem package</strong></a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">mlchem.chem.visualise package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="mlchem-chem-visualise-package">
<h1>mlchem.chem.visualise package<a class="headerlink" href="#mlchem-chem-visualise-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2><em>Submodules</em><a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
<section id="module-mlchem.chem.visualise.drawing">
<span id="mlchem-chem-visualise-drawing-module"></span><h3>mlchem.chem.visualise.drawing module<a class="headerlink" href="#module-mlchem.chem.visualise.drawing" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MolDrawer</span></span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>MolDrawer is a utility class for rendering molecular structures with
customisable visual styles and annotations.</p>
<p>This class provides a flexible interface for drawing molecules using RDKit,
with support for highlighting atoms, adjusting drawing styles, displaying
legends, and visualising similarity or weight maps.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer.mol">
<span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer.mol" title="Link to this definition">¶</a></dt>
<dd><p>The molecule to be drawn.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rdkit.Chem.rdchem.Mol or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer.highlightAtoms">
<span class="sig-name descname"><span class="pre">highlightAtoms</span></span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer.highlightAtoms" title="Link to this definition">¶</a></dt>
<dd><p>List of atom indices to highlight.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer.size">
<span class="sig-name descname"><span class="pre">size</span></span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer.size" title="Link to this definition">¶</a></dt>
<dd><p>Canvas size in pixels as [width, height].</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[int, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer.legend">
<span class="sig-name descname"><span class="pre">legend</span></span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer.legend" title="Link to this definition">¶</a></dt>
<dd><p>Text to display as a legend below the molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer.colour_dictionary">
<span class="sig-name descname"><span class="pre">colour_dictionary</span></span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer.colour_dictionary" title="Link to this definition">¶</a></dt>
<dd><p>Predefined colour palette for drawing.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer.drawing_options">
<span class="sig-name descname"><span class="pre">drawing_options</span></span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer.drawing_options" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary of drawing parameters and visual styles.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialise the MolDrawer with molecule, size, highlights, and legend.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer.show_palette">
<span class="sig-name descname"><span class="pre">show_palette</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer.show_palette" title="Link to this definition">¶</a></dt>
<dd><p>Display or save the colour palette used for drawing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer.update_drawing_options">
<span class="sig-name descname"><span class="pre">update_drawing_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer.update_drawing_options" title="Link to this definition">¶</a></dt>
<dd><p>Update drawing options using a dictionary or keyword arguments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer.reset_drawing_options">
<span class="sig-name descname"><span class="pre">reset_drawing_options</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer.reset_drawing_options" title="Link to this definition">¶</a></dt>
<dd><p>Reset drawing options to their default values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer.draw_mol">
<span class="sig-name descname"><span class="pre">draw_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer.draw_mol" title="Link to this definition">¶</a></dt>
<dd><p>Render a single molecule with the current drawing settings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer.load_images">
<span class="sig-name descname"><span class="pre">load_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer.load_images" title="Link to this definition">¶</a></dt>
<dd><p>Load external images into the drawer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer.load_mols">
<span class="sig-name descname"><span class="pre">load_mols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer.load_mols" title="Link to this definition">¶</a></dt>
<dd><p>Load molecules and generate their images.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.drawing.MolDrawer.show_images_grid">
<span class="sig-name descname"><span class="pre">show_images_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlchem.chem.visualise.drawing.MolDrawer.show_images_grid" title="Link to this definition">¶</a></dt>
<dd><p>Display all loaded images in a grid layout.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlightAtoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[300,</span> <span class="pre">300]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd><p>Initialise the MolDrawer class for molecular visualisation.</p>
<p>This class sets up the molecule, drawing canvas, highlighting options,
and default drawing styles for rendering molecular structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>rdkit.Chem.rdchem.Mol</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The molecule to be drawn. Default is None.</p></li>
<li><p><strong>highlightAtoms</strong> (<em>Iterable</em><em>, </em><em>optional</em>) – List of atom indices to highlight. Default is an empty list.</p></li>
<li><p><strong>size</strong> (<em>Iterable</em><em>, </em><em>optional</em>) – Canvas size as (width, height) in pixels. Default is [300, 300].</p></li>
<li><p><strong>legend</strong> (<em>str</em><em>, </em><em>optional</em>) – Text to display as a legend below the molecule. Default is an empty string.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">draw_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlightAtoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ACS1996_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Image</span></span></span><a class="headerlink" href="#id1" title="Link to this definition">¶</a></dt>
<dd><p>Render and return an image of a single molecule using the current drawing options.</p>
<p>This method draws a molecule with optional atom highlighting, legend text,
custom canvas size, and support for ACS 1996-style rendering. It uses the
drawing configuration stored in the <cite>MolDrawer</cite> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>rdkit.Chem.rdchem.Mol</em><em>, </em><em>optional</em>) – The molecule to be drawn. If None, uses the molecule stored in <cite>self.mol</cite>.</p></li>
<li><p><strong>legend</strong> (<em>str</em><em>, </em><em>optional</em>) – Text to display below the molecule as a legend. Default is an empty string.</p></li>
<li><p><strong>highlightAtoms</strong> (<em>Iterable</em><em>, </em><em>optional</em>) – List of atom indices to highlight. Default is an empty list.</p></li>
<li><p><strong>size</strong> (<em>Iterable</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Canvas size in pixels as (width, height). If None, uses <cite>self.size</cite>.</p></li>
<li><p><strong>ACS1996_mode</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, applies ACS 1996-style drawing conventions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The rendered image of the molecule.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PIL.Image.Image</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CCO&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span> <span class="o">=</span> <span class="n">MolDrawer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">drawer</span><span class="o">.</span><span class="n">draw_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;Ethanol&quot;</span><span class="p">,</span> <span class="n">highlightAtoms</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">load_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Image</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Image</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#id2" title="Link to this definition">¶</a></dt>
<dd><p>Load images into the drawer without adding molecules.</p>
<p>This method allows you to load one or more pre-rendered images into the
MolDrawer instance. These images can be used for visualisation, layout
composition, or exporting as part of a grid.
This method is equivalent to overwrite the img_list attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img_list</strong> (<em>PIL.Image.Image</em><em> or </em><em>Iterable</em><em>[</em><em>PIL.Image.Image</em><em>]</em>) – A single image or a list of images to be added to the drawer.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;example.png&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span> <span class="o">=</span> <span class="n">MolDrawer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span><span class="o">.</span><span class="n">load_images</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span><span class="o">.</span><span class="n">load_images</span><span class="p">([</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">img3</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">load_mols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Mol</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#id3" title="Link to this definition">¶</a></dt>
<dd><p>Load molecules and generate standard images in the drawer.</p>
<p>This method accepts one or more RDKit molecule objects, stores them in the
drawer, and generates their corresponding images using the default or
customised drawing options. These images are stored internally and can be
displayed later in a grid or individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mols</strong> (<em>rdkit.Chem.rdchem.Mol</em><em> or </em><em>Iterable</em><em>[</em><em>rdkit.Chem.rdchem.Mol</em><em>]</em>) – A single molecule or an iterable of molecules to be loaded and rendered.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol1</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CCO&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol2</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;c1ccccc1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span> <span class="o">=</span> <span class="n">MolDrawer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span><span class="o">.</span><span class="n">load_mols</span><span class="p">([</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">reset_drawing_options</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#id4" title="Link to this definition">¶</a></dt>
<dd><p>Reset the drawing options to their default values.</p>
<p>This method reinitialises the internal drawing options dictionary to the
default configuration defined in a fresh instance of the <cite>MolDrawer</cite> class.
It is useful when you want to discard all customisations and revert to the
original visual style.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span> <span class="o">=</span> <span class="n">MolDrawer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span><span class="o">.</span><span class="n">update_drawing_options</span><span class="p">(</span><span class="n">atomPalette</span><span class="o">=</span><span class="s1">&#39;avalon&#39;</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span><span class="o">.</span><span class="n">reset_drawing_options</span><span class="p">()</span>  <span class="c1"># Reverts to default settings</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">show_images_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Image</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty_tile_colour</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#id5" title="Link to this definition">¶</a></dt>
<dd><p>Display all images arranged in a grid layout.</p>
<p>This method arranges a list of images into a grid and displays them using
IPython. It supports customisation of the number of columns, image size,
spacing between images, and background colour for empty tiles. Optionally,
the grid can be saved to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>images</strong> (<em>Iterable</em><em>[</em><em>PIL.Image.Image</em><em>]</em><em>, </em><em>optional</em>) – A list of images to be arranged in the grid. If None, uses the images
stored in <cite>self.img_list</cite>.</p></li>
<li><p><strong>n_columns</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of columns in the grid layout.</p></li>
<li><p><strong>size</strong> (<em>Iterable</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Size of each image in pixels as (width, height). If None, uses the
default size from <cite>self.size</cite>.</p></li>
<li><p><strong>buffer</strong> (<em>int</em><em>, </em><em>default=5</em>) – Space in pixels between images in the grid.</p></li>
<li><p><strong>empty_tile_colour</strong> (<em>str</em><em>, </em><em>default='white'</em>) – Background colour for empty tiles. Must be a valid key in the
<cite>colour_dictionary</cite> attribute.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, saves the grid image to a file.</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>default=''</em>) – Filename to save the image if <cite>save</cite> is True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AssertionError</strong> – If <cite>empty_tile_colour</cite> is not in the colour dictionary or if <cite>size</cite>
    is not a 2-element iterable.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span> <span class="o">=</span> <span class="n">MolDrawer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span><span class="o">.</span><span class="n">load_images</span><span class="p">([</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">img3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span><span class="o">.</span><span class="n">show_images_grid</span><span class="p">(</span><span class="n">n_columns</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span><span class="o">.</span><span class="n">show_images_grid</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;grid_output.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">show_palette</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">palette</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[1000,</span> <span class="pre">300]</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Image</span></span></span><a class="headerlink" href="#id6" title="Link to this definition">¶</a></dt>
<dd><p>Display the colour palette used for molecular drawings.</p>
<p>This method visualises the colour palette as an image. If no palette is
provided, the default <cite>colour_dictionary</cite> is used. The image can also be
saved to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>palette</strong> (<em>dict</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – A dictionary mapping colour names to RGB values. If None, uses the
default palette from <cite>self.colour_dictionary</cite>.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, saves the palette image to a file. Default is False.</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename to save the image if <cite>save</cite> is True. Default is an empty string.</p></li>
<li><p><strong>size</strong> (<em>Iterable</em><em>, </em><em>optional</em>) – Size of the image in pixels as (width, height). Default is [1000, 300].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The image object representing the colour palette.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PIL.Image.Image</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span> <span class="o">=</span> <span class="n">MolDrawer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span><span class="o">.</span><span class="n">show_palette</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span><span class="o">.</span><span class="n">show_palette</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;palette.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">update_drawing_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#id7" title="Link to this definition">¶</a></dt>
<dd><p>Update the RDKit drawing options.</p>
<p>This method allows customisation of the molecule rendering style by updating
the internal drawing options dictionary. Users can pass either a full or
partial dictionary of options, or use keyword arguments directly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**args</strong> (<em>dict</em>) – <p>Keyword arguments representing drawing options. These can include:</p>
<ul class="simple">
<li><dl class="simple">
<dt>atomPalette<span class="classifier">str or dict, default=’cdk’</span></dt><dd><p>Atom colour scheme. Options: ‘avalon’, ‘cdk’, ‘bw’, or a dictionary
mapping atomic numbers to RGB tuples.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>backgroundColour<span class="classifier">str or tuple, default=’white’</span></dt><dd><p>Background colour of the canvas.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>highlightColour<span class="classifier">str or tuple, default=’tomato’</span></dt><dd><p>Colour used for highlighting atoms or bonds.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>highlightAlpha<span class="classifier">float, default=1</span></dt><dd><p>Transparency of the highlight colour (0 = transparent, 1 = opaque).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>queryColour<span class="classifier">str or tuple, default=’red’</span></dt><dd><p>Colour used for SMARTS query atoms.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>annotationColour<span class="classifier">str or tuple, default=’black’</span></dt><dd><p>Colour for annotations (e.g., atom/bond notes).</p>
</dd>
</dl>
</li>
</ul>
<ul class="simple">
<li><p>dummiesAreAttachments : bool, default=False</p></li>
<li><p>addAtomIndices : bool, default=False</p></li>
<li><p>addBondIndices : bool, default=False</p></li>
<li><p>noAtomLabels : bool, default=False</p></li>
<li><p>explicitMethyl : bool, default=False</p></li>
<li><p>includeRadicals : bool, default=True</p></li>
<li><p>useComplexQueryAtomSymbols : bool, default=True</p></li>
<li><p>singleColourWedgeBonds : bool, default=False</p></li>
<li><p>drawMolsSameScale : bool, default=False</p></li>
</ul>
<ul class="simple">
<li><p>continuousHighlight : bool, default=True</p></li>
<li><p>circleAtoms : bool, default=True</p></li>
<li><p>atomHighlightsAreCircles : bool, default=True</p></li>
<li><p>fillHighlights : bool, default=True</p></li>
<li><p>highlightRadius : float, default=0.3</p></li>
<li><p>highlightBondWidthMultiplier : float, default=10</p></li>
</ul>
<ul class="simple">
<li><p>addStereoAnnotation : bool, default=False</p></li>
<li><p>unspecifiedStereoIsUnknown : bool, default=False</p></li>
</ul>
<ul class="simple">
<li><p>baseFontSize : float, default=0.6</p></li>
<li><p>annotationFontScale : float, default=0.5</p></li>
<li><p>legendFontSize : int, default=25</p></li>
<li><p>fixedFontSize : int, default=-1</p></li>
<li><p>minFontSize : int, default=6</p></li>
<li><p>maxFontSize : int, default=40</p></li>
<li><dl class="simple">
<dt>fontFile<span class="classifier">str, default=’’</span></dt><dd><p>Path to a custom font file.</p>
</dd>
</dl>
</li>
</ul>
<ul class="simple">
<li><p>multipleBondOffset : float, default=0.15</p></li>
<li><p>additionalAtomLabelPadding : float, default=0</p></li>
<li><p>bondLineWidth : float, default=2</p></li>
<li><p>scaleBondWidth : bool, default=False</p></li>
<li><p>scaleHighlightBondWidth : bool, default=True</p></li>
<li><p>fixedBondLength : float, default=-1</p></li>
</ul>
<ul class="simple">
<li><p>atomWeights : list, default=[]</p></li>
<li><p>mapStyle : {‘GC’, ‘C’}, default=’GC’</p></li>
<li><p>colourMap : str or list of RGB tuples, default=None</p></li>
<li><p>positiveColour : str or tuple, default=’green’</p></li>
<li><p>negativeColour : str or tuple, default=’mediumvioletred’</p></li>
<li><p>numContours : int, default=10</p></li>
<li><p>weightAlpha : float, default=0.2</p></li>
<li><p>scalingFactor : float, default=2</p></li>
<li><p>minRadius : float, default=2</p></li>
<li><p>maxRadius : float, default=30</p></li>
<li><p>mapRes : float, default=0.5</p></li>
<li><p>contourColour : str or tuple, default=’black’</p></li>
<li><p>contourWidth : float, default=1</p></li>
<li><p>dashNegative : bool, default=True</p></li>
</ul>
<ul class="simple">
<li><p>shapeTypes : list, default=[]</p></li>
<li><p>shapeSizes : list, default=[]</p></li>
<li><p>shapeColours : list, default=[]</p></li>
<li><p>shapeCoords : list, default=[]</p></li>
</ul>
<ul class="simple">
<li><p>clearBackground : bool, default=True</p></li>
<li><p>prepareMolsBeforeDrawing : bool, default=True</p></li>
<li><p>rotate : float, default=0</p></li>
<li><p>padding : float, default=0.05</p></li>
<li><p>atomLabelDeuteriumTritium : bool, default=False</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span> <span class="o">=</span> <span class="n">MolDrawer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span><span class="o">.</span><span class="n">update_drawing_options</span><span class="p">(</span><span class="n">atomPalette</span><span class="o">=</span><span class="s1">&#39;avalon&#39;</span><span class="p">,</span> <span class="n">backgroundColour</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;highlightColour&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;rotate&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drawer</span><span class="o">.</span><span class="n">update_drawing_options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-mlchem.chem.visualise.simmaps">
<span id="mlchem-chem-visualise-simmaps-module"></span><h3>mlchem.chem.visualise.simmaps module<a class="headerlink" href="#module-mlchem.chem.visualise.simmaps" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlchem.chem.visualise.simmaps.SimMaps">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SimMaps</span></span><a class="headerlink" href="#mlchem.chem.visualise.simmaps.SimMaps" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.simmaps.SimMaps.get_similarity_map_from_weights">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_similarity_map_from_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorMap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(250,</span> <span class="pre">250)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordScale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_colour</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contourLines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dash_negative</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw2d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MolDraw2D</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Figure</span></span></span><a class="headerlink" href="#mlchem.chem.visualise.simmaps.SimMaps.get_similarity_map_from_weights" title="Link to this definition">¶</a></dt>
<dd><p>Generate a similarity map visualisation from atomic weights.</p>
<p>This method overlays a similarity map on a molecule using atomic weights,
with optional contour lines and colour maps.</p>
<p>Adapted from RDKit (<a class="reference external" href="https://www.rdkit.org">https://www.rdkit.org</a>), originally licensed under the BSD 3-Clause License.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>rdkit.Chem.rdchem.Mol</em>) – The molecule to visualise.</p></li>
<li><p><strong>weights</strong> (<em>Iterable</em>) – Atomic weights to visualise.</p></li>
<li><p><strong>colorMap</strong> (<em>str</em><em> or </em><em>list</em><em> or </em><em>matplotlib colormap</em><em>, </em><em>optional</em>) – Colour map to use. If None, a custom PiWG colour map is used.</p></li>
<li><p><strong>scale</strong> (<em>int</em><em>, </em><em>default=-1</em>) – Scaling factor. If negative, uses the maximum absolute weight.</p></li>
<li><p><strong>size</strong> (<em>tuple</em><em>, </em><em>default=</em><em>(</em><em>250</em><em>, </em><em>250</em><em>)</em>) – Size of the output image.</p></li>
<li><p><strong>sigma</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian width. If None, estimated from bond lengths.</p></li>
<li><p><strong>coordScale</strong> (<em>float</em><em>, </em><em>default=1.5</em>) – Scaling factor for coordinates.</p></li>
<li><p><strong>step</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Step size for Gaussian calculation.</p></li>
<li><p><strong>contour_colour</strong> (<em>str</em><em> or </em><em>tuple</em><em>, </em><em>default='black'</em>) – Colour of contour lines. Can be a string or RGB tuple.</p></li>
<li><p><strong>contourLines</strong> (<em>int</em><em> or </em><em>list</em><em>, </em><em>default=10</em>) – Number of contour lines or specific contour levels.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Transparency of contour lines.</p></li>
<li><p><strong>contour_width</strong> (<em>float</em><em>, </em><em>default=1</em>) – Width of contour lines.</p></li>
<li><p><strong>resolution</strong> (<em>float</em><em>, </em><em>default=0.05</em>) – Grid resolution for contour plotting.</p></li>
<li><p><strong>dash_negative</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use dashed lines for negative weights.</p></li>
<li><p><strong>draw2d</strong> (<em>rdkit.Chem.Draw.rdMolDraw2D.MolDraw2D</em><em>, </em><em>optional</em>) – RDKit drawing object. Required for rendering.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to matplotlib drawing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If <cite>draw2d</cite> is provided, returns the modified drawing object.
Otherwise, returns a matplotlib figure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rdMolDraw2D.MolDraw2D or matplotlib.figure.Figure</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>draw2d</cite> is not provided or the molecule has fewer than 2 atoms.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">SimMaps</span><span class="o">.</span><span class="n">get_similarity_map_from_weights</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">draw2d</span><span class="o">=</span><span class="n">drawer</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.simmaps.SimMaps.get_weights_from_fingerprint">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_weights_from_fingerprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">refmol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probemol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'m'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'ap'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'rk'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'tt'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'m'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'Tanimoto'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Dice'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Cosine'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Sokal'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Russel'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'RogotGoldberg'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'AllBit'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'OnBit'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Kulczynski'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'McConnaughey'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Asymmetric'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'BraunBlanquet'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'Tversky'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Tanimoto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#mlchem.chem.visualise.simmaps.SimMaps.get_weights_from_fingerprint" title="Link to this definition">¶</a></dt>
<dd><p>Get atomic importance weights based on fingerprint similarity.</p>
<p>This method calculates atomic contributions by masking atoms in the probe
molecule and computing the change in similarity to a reference molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>refmol</strong> (<em>rdkit.Chem.rdchem.Mol</em>) – The reference molecule.</p></li>
<li><p><strong>probemol</strong> (<em>rdkit.Chem.rdchem.Mol</em>) – The probe molecule whose atoms will be masked.</p></li>
<li><p><strong>fp_type</strong> (<em>{'m'</em><em>, </em><em>'ap'</em><em>, </em><em>'rk'</em><em>, </em><em>'tt'}</em><em>, </em><em>default='m'</em>) – Type of fingerprint to use.</p></li>
<li><p><strong>similarity_metric</strong> (<em>str</em><em>, </em><em>default='Tanimoto'</em>) – Similarity metric to use. Options include:
‘Tanimoto’, ‘Dice’, ‘Cosine’, ‘Sokal’, ‘Russel’, ‘RogotGoldberg’,
‘AllBit’, ‘OnBit’, ‘Kulczynski’, ‘McConnaughey’, ‘Asymmetric’,
‘BraunBlanquet’, ‘Tversky’.</p></li>
<li><p><strong>normalise</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, normalises the weights to the range (-1, 1). Default is False.</p></li>
<li><p><strong>return_df</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, returns a pandas DataFrame. Otherwise, returns a NumPy array.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Additional fingerprint-specific parameters. See below.</p></li>
<li><p><strong>Parameters</strong> (<em>Fingerprint</em>)</p></li>
<li><p><strong>----------------------</strong></p></li>
<li><p><strong>(</strong><strong>'m'</strong><strong>)</strong> (<em>Morgan</em>)</p></li>
<li><p><strong>radius</strong> (<em>-</em>)</p></li>
<li><p><strong>fpType</strong> (<em>-</em>)</p></li>
<li><p><strong>atomId</strong> (<em>-</em>)</p></li>
<li><p><strong>nBits</strong> (<em>-</em>)</p></li>
<li><p><strong>useFeatures</strong> (<em>-</em>)</p></li>
<li><p><strong>(</strong><strong>'ap'</strong><strong>)</strong> (<em>Atom Pair</em>)</p></li>
<li><p><strong>fpType</strong></p></li>
<li><p><strong>atomId</strong></p></li>
<li><p><strong>nBits</strong></p></li>
<li><p><strong>minLength</strong> (<em>-</em>)</p></li>
<li><p><strong>maxLength</strong> (<em>-</em>)</p></li>
<li><p><strong>nBitsPerEntry</strong> (<em>-</em>)</p></li>
<li><p><strong>(</strong><strong>'tt'</strong><strong>)</strong> (<em>Topological Torsion</em>)</p></li>
<li><p><strong>fpType</strong></p></li>
<li><p><strong>atomId</strong></p></li>
<li><p><strong>nBits</strong></p></li>
<li><p><strong>targetSize</strong> (<em>-</em>)</p></li>
<li><p><strong>nBitsPerEntry</strong></p></li>
<li><p><strong>(</strong><strong>'rk'</strong><strong>)</strong> (<em>RDKit</em>)</p></li>
<li><p><strong>fpType</strong></p></li>
<li><p><strong>atomId</strong></p></li>
<li><p><strong>nBits</strong></p></li>
<li><p><strong>minPath</strong> (<em>-</em>)</p></li>
<li><p><strong>maxPath</strong> (<em>-</em>)</p></li>
<li><p><strong>nBitsPerHash</strong> (<em>-</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Atomic contributions to similarity. Format depends on <cite>return_df</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Iterable or pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">SimMaps</span><span class="o">.</span><span class="n">get_weights_from_fingerprint</span><span class="p">(</span><span class="n">refmol</span><span class="p">,</span> <span class="n">probemol</span><span class="p">,</span> <span class="n">fp_type</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.simmaps.SimMaps.get_weights_from_model">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_weights_from_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mol</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'regression'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'classification'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actual_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'m'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'ap'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'tt'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'rk'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#mlchem.chem.visualise.simmaps.SimMaps.get_weights_from_model" title="Link to this definition">¶</a></dt>
<dd><p>Get atomic importance weights from a predictive model using masked fingerprints.</p>
<p>This method calculates atomic contributions by iteratively masking each atom
in the molecule and evaluating the change in model prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol_input</strong> (<em>rdkit.Chem.rdchem.Mol</em><em> or </em><em>str</em>) – The input molecule as an RDKit Mol object or a SMILES string.</p></li>
<li><p><strong>estimator</strong> (<em>sklearn.base.BaseEstimator</em>) – A trained scikit-learn estimator.</p></li>
<li><p><strong>estimator_cols</strong> (<em>Iterable</em>) – Feature names used by the estimator.</p></li>
<li><p><strong>model_type</strong> (<em>{'regression'</em><em>, </em><em>'classification'}</em>) – Type of model. Must be either ‘regression’ or ‘classification’.</p></li>
<li><p><strong>actual_val</strong> (<em>float</em>) – The actual value predicted by the model. For classification, this is the
probability of class 1; for regression, the continuous target value.</p></li>
<li><p><strong>fp_type</strong> (<em>{'m'</em><em>, </em><em>'ap'</em><em>, </em><em>'tt'</em><em>, </em><em>'rk'}</em>) – Type of fingerprint to use:
- ‘m’: Morgan
- ‘ap’: Atom Pair
- ‘tt’: Topological Torsion
- ‘rk’: RDKit</p></li>
<li><p><strong>normalise</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, normalises the weights to the range (-1, 1). Default is False.</p></li>
<li><p><strong>return_df</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, returns a pandas DataFrame. Otherwise, returns a NumPy array.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Additional fingerprint-specific parameters. See below.</p></li>
<li><p><strong>Parameters</strong> (<em>Fingerprint</em>)</p></li>
<li><p><strong>----------------------</strong></p></li>
<li><p><strong>(</strong><strong>'m'</strong><strong>)</strong> (<em>Morgan</em>)</p></li>
<li><p><strong>radius</strong> (<em>-</em>) – Radius of the Morgan fingerprint.</p></li>
<li><p><strong>fpType</strong> (<em>-</em>) – Type of fingerprint: bit vector (‘bv’) or count-based.</p></li>
<li><p><strong>atomId</strong> (<em>-</em>) – Atom to mask. -1 means no masking.</p></li>
<li><p><strong>nBits</strong> (<em>-</em>) – Size of the bit vector.</p></li>
<li><p><strong>useFeatures</strong> (<em>-</em>) – If True, uses FeatureMorgan; otherwise, ConnectivityMorgan.</p></li>
<li><p><strong>(</strong><strong>'ap'</strong><strong>)</strong> (<em>Atom Pair</em>)</p></li>
<li><p><strong>fpType</strong></p></li>
<li><p><strong>atomId</strong></p></li>
<li><p><strong>nBits</strong></p></li>
<li><p><strong>minLength</strong> (<em>-</em>)</p></li>
<li><p><strong>maxLength</strong> (<em>-</em>)</p></li>
<li><p><strong>nBitsPerEntry</strong> (<em>-</em>)</p></li>
<li><p><strong>(</strong><strong>'tt'</strong><strong>)</strong> (<em>Topological Torsion</em>)</p></li>
<li><p><strong>fpType</strong></p></li>
<li><p><strong>atomId</strong></p></li>
<li><p><strong>nBits</strong></p></li>
<li><p><strong>targetSize</strong> (<em>-</em>)</p></li>
<li><p><strong>nBitsPerEntry</strong></p></li>
<li><p><strong>(</strong><strong>'rk'</strong><strong>)</strong> (<em>RDKit</em>)</p></li>
<li><p><strong>fpType</strong></p></li>
<li><p><strong>atomId</strong></p></li>
<li><p><strong>nBits</strong></p></li>
<li><p><strong>minPath</strong> (<em>-</em>)</p></li>
<li><p><strong>maxPath</strong> (<em>-</em>)</p></li>
<li><p><strong>nBitsPerHash</strong> (<em>-</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Atomic contributions to model prediction. Format depends on <cite>return_df</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Iterable or pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">SimMaps</span><span class="o">.</span><span class="n">get_weights_from_model</span><span class="p">(</span><span class="s2">&quot;CCO&quot;</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="s2">&quot;regression&quot;</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-mlchem.chem.visualise.space">
<span id="mlchem-chem-visualise-space-module"></span><h3>mlchem.chem.visualise.space module<a class="headerlink" href="#module-mlchem.chem.visualise.space" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="mlchem.chem.visualise.space.ChemicalSpace">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ChemicalSpace</span></span><a class="headerlink" href="#mlchem.chem.visualise.space.ChemicalSpace" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A module to compute and visualise datasets in a compressed embedded space.</p>
<p>This class handles descriptor processing, dimensionality reduction,
and preparation of molecular data for interactive visualisation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – A DataFrame with 3 or 4 columns: ‘SMILES’, ‘NAME’, ‘CLASS’,
and optionally ‘METADATA’.</p></li>
<li><p><strong>needs_cleaning</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the data requires cleaning. Default is False.</p></li>
<li><p><strong>df_descriptors</strong> (<em>pd.DataFrame</em><em>, </em><em>optional</em>) – A DataFrame with SMILES as index and descriptor columns.</p></li>
<li><p><strong>metadata_exists</strong> (<em>bool</em><em>, </em><em>optional</em>) – True if a 4th column is present in <cite>data</cite>. Default is False.</p></li>
<li><p><strong>metadata_categorical</strong> (<em>bool</em><em>, </em><em>optional</em>) – True if the 4th column is categorical. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the input <cite>data</cite> does not have the expected column structure.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.space.ChemicalSpace.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">needs_cleaning</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_descriptors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata_exists</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata_categorical</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlchem.chem.visualise.space.ChemicalSpace.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialise a ChemicalSpace object for visualising molecular datasets
in a compressed embedded space.</p>
<p>This constructor sets up the molecular data, descriptor matrix,
and metadata flags. It also validates the structure of the input
data and loads default Bokeh visualisation settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – A DataFrame with either 3 or 4 columns:
- ‘SMILES’: SMILES strings of the molecules.
- ‘NAME’: Names or identifiers of the molecules.
- ‘CLASS’: Class labels for grouping or colouring.
- ‘METADATA’ (optional): Additional metadata for further grouping.</p></li>
<li><p><strong>needs_cleaning</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the data requires cleaning before processing. Default is False.</p></li>
<li><p><strong>df_descriptors</strong> (<em>pd.DataFrame</em><em>, </em><em>optional</em>) – A DataFrame with SMILES as index and molecular descriptors as columns.</p></li>
<li><p><strong>metadata_exists</strong> (<em>bool</em><em>, </em><em>optional</em>) – True if a fourth column (‘METADATA’) is present in <cite>data</cite>. Default is False.</p></li>
<li><p><strong>metadata_categorical</strong> (<em>bool</em><em>, </em><em>optional</em>) – True if the metadata column is categorical. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the <cite>data</cite> DataFrame does not have the expected column structure.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If <cite>df_descriptors</cite> is not provided, a message will be printed to
remind the user to supply descriptors before visualisation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span> <span class="o">=</span> <span class="n">ChemicalSpace</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">df_descriptors</span><span class="o">=</span><span class="n">desc_df</span><span class="p">,</span> <span class="n">metadata_exists</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.space.ChemicalSpace.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colour_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_fontsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">650</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">866</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_html</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mlchem.chem.visualise.space.ChemicalSpace.plot" title="Link to this definition">¶</a></dt>
<dd><p>Generate a 2D scatter plot of the chemical space using Bokeh.</p>
<p>This method visualises the compressed chemical space using a scatter plot,
with options to customise colours, shapes, size, and layout. It supports
categorical metadata and can optionally save the plot as an HTML file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>colour_list</strong> (<em>list</em><em>, </em><em>optional</em>) – List of colours for the plot markers. Each class will be assigned a
colour. If not provided, defaults to:
[‘Blue’, ‘Orange’, ‘Red’, ‘Black’, ‘Green’, ‘Cyan’, ‘Magenta’, ‘Yellow’].</p></li>
<li><p><strong>shape_list</strong> (<em>list</em><em>, </em><em>optional</em>) – List of marker shapes. If not provided, defaults to:
[‘circle’, ‘triangle’, ‘square’, ‘star’, ‘diamond’, ‘cross’, ‘x’, ‘asterisk’].</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the file to save the plot as (without extension).</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Title of the plot.</p></li>
<li><p><strong>title_fontsize</strong> (<em>int</em><em>, </em><em>optional</em>) – Font size of the plot title. Default is 25.</p></li>
<li><p><strong>height</strong> (<em>int</em><em>, </em><em>optional</em>) – Height of the plot in pixels. Default is 650.</p></li>
<li><p><strong>width</strong> (<em>int</em><em>, </em><em>optional</em>) – Width of the plot in pixels. Default is 866 (650 / 0.75).</p></li>
<li><p><strong>marker_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the plot markers. Default is 10.</p></li>
<li><p><strong>save_html</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to save the plot as an HTML file. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays the plot in a Jupyter notebook and optionally saves it as HTML.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chem_space</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">colour_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">shape_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;square&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;my_plot&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Chemical Space&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save_html</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.space.ChemicalSpace.prepare">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_compressed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlchem.chem.visualise.space.ChemicalSpace.prepare" title="Link to this definition">¶</a></dt>
<dd><p>Prepare the compressed dataframe for visualisation.</p>
<p>This method adds molecular structure files, names, and metadata
to the compressed coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df_compressed</strong> (<em>pd.DataFrame</em>) – A DataFrame with two columns [‘DIM_1’, ‘DIM_2’] representing
the compressed coordinates of the molecules.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updates the instance with prepared data for visualisation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – If <cite>df_compressed</cite> does not have exactly two columns named
    [‘DIM_1’, ‘DIM_2’].</p></li>
<li><p><strong>ValueError</strong> – If the index of <cite>df_compressed</cite> or <cite>df_processed</cite> is not a
    series of SMILES strings.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chem_space</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">df_compressed</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.space.ChemicalSpace.process">
<span class="sig-name descname"><span class="pre">process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diversity_filter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collinearity_filter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlchem.chem.visualise.space.ChemicalSpace.process" title="Link to this definition">¶</a></dt>
<dd><p>Process the descriptor data by applying diversity and collinearity filters,
and optionally standardising the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>diversity_filter</strong> (<em>float</em><em> or </em><em>None</em>) – A float between 0 and 1. Higher values apply stricter filtering
to remove less diverse descriptors.</p></li>
<li><p><strong>collinearity_filter</strong> (<em>float</em><em> or </em><em>None</em>) – A float between 0 and 1. Higher values apply looser filtering
to remove more collinear descriptors.</p></li>
<li><p><strong>standardise</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to standardise the filtered descriptor data. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updates the instance with processed descriptor data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – If <cite>diversity_filter</cite> or <cite>collinearity_filter</cite> are outside [0, 1).</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chem_space</span> <span class="o">=</span> <span class="n">ChemicalSpace</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">df_descriptors</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chem_space</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">diversity_filter</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">collinearity_filter</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.space.ChemicalSpace.reset_bokeh_options">
<span class="sig-name descname"><span class="pre">reset_bokeh_options</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mlchem.chem.visualise.space.ChemicalSpace.reset_bokeh_options" title="Link to this definition">¶</a></dt>
<dd><p>Reset Bokeh plot options to their default values.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chem_space</span><span class="o">.</span><span class="n">reset_bokeh_options</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.space.ChemicalSpace.reset_bokeh_tooltips">
<span class="sig-name descname"><span class="pre">reset_bokeh_tooltips</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mlchem.chem.visualise.space.ChemicalSpace.reset_bokeh_tooltips" title="Link to this definition">¶</a></dt>
<dd><p>Reset Bokeh tooltips to their default values.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chem_space</span><span class="o">.</span><span class="n">reset_bokeh_tooltips</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlchem.chem.visualise.space.ChemicalSpace.update_bokeh_options">
<span class="sig-name descname"><span class="pre">update_bokeh_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#mlchem.chem.visualise.space.ChemicalSpace.update_bokeh_options" title="Link to this definition">¶</a></dt>
<dd><p>Update the Bokeh plot options.</p>
<p>This method allows customisation of various Bokeh plot parameters
for visualisations. Users can pass keyword arguments to set options
such as title properties, legend properties, and axis properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title_location</strong> (<em>str</em><em>, </em><em>optional</em>) – Location of the title. Options: ‘above’, ‘below’, ‘left’, ‘right’.</p></li>
<li><p><strong>title_fontsize</strong> (<em>str</em><em>, </em><em>optional</em>) – Font size of the title (e.g., ‘25px’).</p></li>
<li><p><strong>title_align</strong> (<em>str</em><em>, </em><em>optional</em>) – Alignment of the title. Options: ‘left’, ‘center’, ‘right’.</p></li>
<li><p><strong>title_background_fill_colour</strong> (<em>str</em><em>, </em><em>optional</em>) – Background colour of the title.</p></li>
<li><p><strong>title_text_colour</strong> (<em>str</em><em>, </em><em>optional</em>) – Text colour of the title.</p></li>
<li><p><strong>legend_location</strong> (<em>str</em><em>, </em><em>optional</em>) – Location of the legend. Options: ‘top_left’, ‘top_center’,
‘top_right’, ‘center_right’, ‘bottom_right’, ‘bottom_center’,
‘bottom_left’, ‘center_left’, ‘center’.</p></li>
<li><p><strong>legend_title</strong> (<em>str</em><em>, </em><em>optional</em>) – Title of the legend.</p></li>
<li><p><strong>legend_label_text_font</strong> (<em>str</em><em>, </em><em>optional</em>) – Font of the legend labels (e.g., ‘times’).</p></li>
<li><p><strong>legend_label_text_font_style</strong> (<em>str</em><em>, </em><em>optional</em>) – Font style of the legend labels (e.g., ‘italic’).</p></li>
<li><p><strong>legend_label_text_colour</strong> (<em>str</em><em>, </em><em>optional</em>) – Text colour of the legend labels.</p></li>
<li><p><strong>legend_border_line_width</strong> (<em>int</em><em>, </em><em>optional</em>) – Line width of the legend border.</p></li>
<li><p><strong>legend_border_line_colour</strong> (<em>str</em><em>, </em><em>optional</em>) – Line colour of the legend border.</p></li>
<li><p><strong>legend_border_line_alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Transparency of the legend border (0 to 1).</p></li>
<li><p><strong>legend_background_fill_colour</strong> (<em>str</em><em>, </em><em>optional</em>) – Background colour of the legend.</p></li>
<li><p><strong>legend_background_fill_alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Transparency of the legend background (0 to 1).</p></li>
<li><p><strong>xaxis_label</strong> (<em>str</em><em>, </em><em>optional</em>) – Label of the x-axis.</p></li>
<li><p><strong>xaxis_line_width</strong> (<em>int</em><em>, </em><em>optional</em>) – Line width of the x-axis.</p></li>
<li><p><strong>xaxis_line_colour</strong> (<em>str</em><em>, </em><em>optional</em>) – Line colour of the x-axis.</p></li>
<li><p><strong>xaxis_major_label_text_colour</strong> (<em>str</em><em>, </em><em>optional</em>) – Text colour of the x-axis major labels.</p></li>
<li><p><strong>xaxis_major_label_orientation</strong> (<em>str</em><em>, </em><em>optional</em>) – Orientation of the x-axis major labels. Options: ‘horizontal’, ‘vertical’.</p></li>
<li><p><strong>yaxis_label</strong> (<em>str</em><em>, </em><em>optional</em>) – Label of the y-axis.</p></li>
<li><p><strong>yaxis_line_width</strong> (<em>int</em><em>, </em><em>optional</em>) – Line width of the y-axis.</p></li>
<li><p><strong>yaxis_line_colour</strong> (<em>str</em><em>, </em><em>optional</em>) – Line colour of the y-axis.</p></li>
<li><p><strong>yaxis_major_label_text_colour</strong> (<em>str</em><em>, </em><em>optional</em>) – Text colour of the y-axis major labels.</p></li>
<li><p><strong>yaxis_major_label_orientation</strong> (<em>str</em><em>, </em><em>optional</em>) – Orientation of the y-axis major labels. Options: ‘horizontal’, ‘vertical’.</p></li>
<li><p><strong>axis_minor_tick_in</strong> (<em>int</em><em>, </em><em>optional</em>) – Length of the minor ticks inward.</p></li>
<li><p><strong>axis_minor_tick_out</strong> (<em>int</em><em>, </em><em>optional</em>) – Length of the minor ticks outward.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="o">.</span><span class="n">update_bokeh_options</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">title_location</span><span class="o">=</span><span class="s1">&#39;above&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">title_fontsize</span><span class="o">=</span><span class="s1">&#39;20px&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">legend_location</span><span class="o">=</span><span class="s1">&#39;top_right&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">xaxis_label</span><span class="o">=</span><span class="s1">&#39;PC1&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">yaxis_label</span><span class="o">=</span><span class="s1">&#39;PC2&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">mlchem.chem.visualise package</a><ul>
<li><a class="reference internal" href="#submodules"><em>Submodules</em></a><ul>
<li><a class="reference internal" href="#module-mlchem.chem.visualise.drawing">mlchem.chem.visualise.drawing module</a><ul>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer"><code class="docutils literal notranslate"><span class="pre">MolDrawer</span></code></a><ul>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer.mol"><code class="docutils literal notranslate"><span class="pre">MolDrawer.mol</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer.highlightAtoms"><code class="docutils literal notranslate"><span class="pre">MolDrawer.highlightAtoms</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer.size"><code class="docutils literal notranslate"><span class="pre">MolDrawer.size</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer.legend"><code class="docutils literal notranslate"><span class="pre">MolDrawer.legend</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer.colour_dictionary"><code class="docutils literal notranslate"><span class="pre">MolDrawer.colour_dictionary</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer.drawing_options"><code class="docutils literal notranslate"><span class="pre">MolDrawer.drawing_options</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer.__init__"><code class="docutils literal notranslate"><span class="pre">MolDrawer.__init__()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer.show_palette"><code class="docutils literal notranslate"><span class="pre">MolDrawer.show_palette()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer.update_drawing_options"><code class="docutils literal notranslate"><span class="pre">MolDrawer.update_drawing_options()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer.reset_drawing_options"><code class="docutils literal notranslate"><span class="pre">MolDrawer.reset_drawing_options()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer.draw_mol"><code class="docutils literal notranslate"><span class="pre">MolDrawer.draw_mol()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer.load_images"><code class="docutils literal notranslate"><span class="pre">MolDrawer.load_images()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer.load_mols"><code class="docutils literal notranslate"><span class="pre">MolDrawer.load_mols()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.drawing.MolDrawer.show_images_grid"><code class="docutils literal notranslate"><span class="pre">MolDrawer.show_images_grid()</span></code></a></li>
<li><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">MolDrawer.__init__()</span></code></a></li>
<li><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">MolDrawer.draw_mol()</span></code></a></li>
<li><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">MolDrawer.load_images()</span></code></a></li>
<li><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">MolDrawer.load_mols()</span></code></a></li>
<li><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">MolDrawer.reset_drawing_options()</span></code></a></li>
<li><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">MolDrawer.show_images_grid()</span></code></a></li>
<li><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">MolDrawer.show_palette()</span></code></a></li>
<li><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">MolDrawer.update_drawing_options()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-mlchem.chem.visualise.simmaps">mlchem.chem.visualise.simmaps module</a><ul>
<li><a class="reference internal" href="#mlchem.chem.visualise.simmaps.SimMaps"><code class="docutils literal notranslate"><span class="pre">SimMaps</span></code></a><ul>
<li><a class="reference internal" href="#mlchem.chem.visualise.simmaps.SimMaps.get_similarity_map_from_weights"><code class="docutils literal notranslate"><span class="pre">SimMaps.get_similarity_map_from_weights()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.simmaps.SimMaps.get_weights_from_fingerprint"><code class="docutils literal notranslate"><span class="pre">SimMaps.get_weights_from_fingerprint()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.simmaps.SimMaps.get_weights_from_model"><code class="docutils literal notranslate"><span class="pre">SimMaps.get_weights_from_model()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-mlchem.chem.visualise.space">mlchem.chem.visualise.space module</a><ul>
<li><a class="reference internal" href="#mlchem.chem.visualise.space.ChemicalSpace"><code class="docutils literal notranslate"><span class="pre">ChemicalSpace</span></code></a><ul>
<li><a class="reference internal" href="#mlchem.chem.visualise.space.ChemicalSpace.__init__"><code class="docutils literal notranslate"><span class="pre">ChemicalSpace.__init__()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.space.ChemicalSpace.plot"><code class="docutils literal notranslate"><span class="pre">ChemicalSpace.plot()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.space.ChemicalSpace.prepare"><code class="docutils literal notranslate"><span class="pre">ChemicalSpace.prepare()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.space.ChemicalSpace.process"><code class="docutils literal notranslate"><span class="pre">ChemicalSpace.process()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.space.ChemicalSpace.reset_bokeh_options"><code class="docutils literal notranslate"><span class="pre">ChemicalSpace.reset_bokeh_options()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.space.ChemicalSpace.reset_bokeh_tooltips"><code class="docutils literal notranslate"><span class="pre">ChemicalSpace.reset_bokeh_tooltips()</span></code></a></li>
<li><a class="reference internal" href="#mlchem.chem.visualise.space.ChemicalSpace.update_bokeh_options"><code class="docutils literal notranslate"><span class="pre">ChemicalSpace.update_bokeh_options()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="mlchem.chem.calculator.html"
                          title="previous chapter">mlchem.chem.calculator package</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="mlchem.ml.html"
                          title="next chapter"><strong>mlchem.ml package</strong></a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/mlchem.chem.visualise.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mlchem.ml.html" title="mlchem.ml package"
             >next</a> |</li>
        <li class="right" >
          <a href="mlchem.chem.calculator.html" title="mlchem.chem.calculator package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">mlchem 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" ><strong>mlchem package</strong></a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="mlchem.html" ><strong>chem and ml subpackages</strong></a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="mlchem.chem.html" ><strong>mlchem.chem package</strong></a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">mlchem.chem.visualise package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, Leonardo Contreas.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>
